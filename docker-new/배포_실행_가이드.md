# ğŸš€ ë°°í¬ ì‹¤í–‰ ê°€ì´ë“œ

ì••ì¶• íŒŒì¼ì´ ì´ë¯¸ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤: `/tmp/aiapp-deploy.tar.gz`

## ğŸ“‹ 3ë‹¨ê³„ë¡œ ëë‚´ê¸°

---

### 1ï¸âƒ£ íŒŒì¼ ì „ì†¡

ë¡œì»¬ í„°ë¯¸ë„ì—ì„œ:

```bash
scp /tmp/aiapp-deploy.tar.gz dksw@223.130.151.39:/tmp/
```

ë¹„ë°€ë²ˆí˜¸ ì…ë ¥: `dksw.123`

---

### 2ï¸âƒ£ ì„œë²„ ì ‘ì† ë° ë°°í¬

```bash
ssh dksw@223.130.151.39
```

ë¹„ë°€ë²ˆí˜¸ ì…ë ¥: `dksw.123`

---

### 3ï¸âƒ£ ì„œë²„ì—ì„œ ì‹¤í–‰ (ë³µì‚¬-ë¶™ì—¬ë„£ê¸°)

ì•„ë˜ ì „ì²´ ëª…ë ¹ì„ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”:

```bash
# ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì¤‘ì§€
cd /home/dksw/aiapp/docker 2>/dev/null && docker-compose down -v || echo "No containers"

# ê¸°ì¡´ ë””ë ‰í† ë¦¬ ë°±ì—…
cd /home/dksw
if [ -d "aiapp" ]; then
    mv aiapp aiapp.backup.$(date +%Y%m%d_%H%M%S) 2>/dev/null || rm -rf aiapp
fi

# ìƒˆ ë””ë ‰í† ë¦¬ ìƒì„± ë° ì••ì¶• í•´ì œ
mkdir -p aiapp
cd aiapp
tar -xzf /tmp/aiapp-deploy.tar.gz
rm /tmp/aiapp-deploy.tar.gz

# ë°ì´í„° ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p data/{mysql,redis,logs/{aiif,aipf}}

# Docker ì‹¤í–‰
cd docker
docker-compose up -d --build

# ê²°ê³¼ í™•ì¸
echo ""
echo "=========================================="
echo "âœ… ë°°í¬ ì™„ë£Œ!"
echo "=========================================="
echo ""
docker-compose ps
```

---

## ğŸ“Š ë°°í¬ í™•ì¸

### ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸

```bash
cd /home/dksw/aiapp/docker
docker-compose ps
```

### ë¡œê·¸ í™•ì¸

```bash
# ì „ì²´ ë¡œê·¸
docker-compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ
docker-compose logs -f aiif
docker-compose logs -f aipf
docker-compose logs -f mysql

# Ctrl+Cë¡œ ì¢…ë£Œ
```

### í—¬ìŠ¤ì²´í¬

ë¡œì»¬ì—ì„œ:

```bash
# AIIF
curl http://223.130.151.39:1024/actuator/health

# AIPF
curl http://223.130.151.39:2022/actuator/health

# Nginx
curl http://223.130.151.39/health
```

---

## ğŸ”§ ì„œë¹„ìŠ¤ ê´€ë¦¬

### ì¬ì‹œì‘

```bash
cd /home/dksw/aiapp/docker
docker-compose restart
```

### ì¤‘ì§€

```bash
cd /home/dksw/aiapp/docker
docker-compose stop
```

### ì‹œì‘

```bash
cd /home/dksw/aiapp/docker
docker-compose start
```

### ë¡œê·¸ íŒŒì¼ í™•ì¸

```bash
cd /home/dksw/aiapp/data/logs

# AIIF ë¡œê·¸
tail -f aiif/aiif.log
tail -f aiif/aiif-error.log

# AIPF ë¡œê·¸
tail -f aipf/aipf.log
tail -f aipf/aipf-error.log
```

---

## ğŸŒ ì ‘ì† ì •ë³´

ë°°í¬ ì™„ë£Œ í›„ ì ‘ì† ê°€ëŠ¥í•œ URL:

- **AIIF API**: http://223.130.151.39:1024
- **AIPF API**: http://223.130.151.39:2022
- **Nginx**: http://223.130.151.39:80
- **MySQL**: 223.130.151.39:3306
- **Redis**: 223.130.151.39:6379

---

## ğŸ› ë¬¸ì œ í•´ê²°

### MySQLì´ ì•ˆ ì˜¬ë¼ì˜¬ ë•Œ

```bash
cd /home/dksw/aiapp/docker
docker-compose logs mysql

# ë°ì´í„° ì´ˆê¸°í™”ê°€ í•„ìš”í•˜ë©´
docker-compose down -v
rm -rf ../data/mysql/*
docker-compose up -d --build
```

### ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘ ì•ˆ ë  ë•Œ

```bash
# ì„¤ì • íŒŒì¼ í™•ì¸
cat /home/dksw/aiapp/config/env/aiif.env
cat /home/dksw/aiapp/config/app/aiif/application-prod.yml

# ë¡œê·¸ í™•ì¸
docker-compose logs aiif | tail -100
```

### ì „ì²´ ì¬ë°°í¬

```bash
cd /home/dksw/aiapp/docker
docker-compose down -v
cd /home/dksw
rm -rf aiapp

# ë‹¤ì‹œ 1ë‹¨ê³„ë¶€í„° ì‹œì‘
```

---

## ğŸ’¡ í•µì‹¬ ê°œë…

ì´ ìƒˆë¡œìš´ êµ¬ì¡°ì˜ ì¥ì :

1. **ì„¤ì • ì™¸ë¶€í™”**: `application.yml`, `log4j2.xml` ëª¨ë‘ ì™¸ë¶€ì—ì„œ ì£¼ì…
2. **ì¬ë¹Œë“œ ë¶ˆí•„ìš”**: ì„¤ì • ë³€ê²½ í›„ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘ë§Œìœ¼ë¡œ ë°˜ì˜
3. **í™˜ê²½ ë¶„ë¦¬**: `config/env/` ë§Œ ë°”ê¾¸ë©´ dev/prod ì „í™˜
4. **ë¡œê·¸ ì˜êµ¬ ë³´ê´€**: ì»¨í…Œì´ë„ˆ ì‚­ì œí•´ë„ ë¡œê·¸ ìœ ì§€
5. **ìš´ì˜ ì•ˆì •ì„±**: ì„¤ì • ë¡¤ë°± ì¦‰ì‹œ ê°€ëŠ¥

---

## ğŸ“ ì§€ì›

ë¬¸ì œ ë°œìƒ ì‹œ:

```bash
# ì‹œìŠ¤í…œ ìƒíƒœ ì „ì²´ í™•ì¸
cd /home/dksw/aiapp/docker
docker-compose ps
docker-compose logs --tail=100

# ë¦¬ì†ŒìŠ¤ í™•ì¸
free -h
df -h
docker stats --no-stream
```
